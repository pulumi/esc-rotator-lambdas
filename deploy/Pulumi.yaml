name: esc-rotator-lambda
runtime: nodejs
description: This pulumi program will deploy the rotation lambda into your VPC and will set up a role to allow ESC to invoke it.
template:
  config:
    aws:region:
      description: The AWS region to deploy into
      default: us-west-2
    rdsId:
      description: The ID of the RDS cluster the lambda will proxy access to.
    lambdaArchiveBucketPrefix:
      description: The name prefix of the regional s3 bucket that contains the lambda code archive
      default: public-esc-rotator-lambdas-production
    lambdaArchiveKey:
      description: The key of the lambda archive to deploy
      default: aws-lambda/latest.zip
    lambdaArchiveSigningProfileVersionArn:
      description: This signing profile is used to verify the authenticity of the lambda bundle
      default: arn:aws:signer:us-west-2:388588623842:/signing-profiles/pulumi_esc_production_20250325212043887700000001/jva5X9nqMa
    trustedAccount:
      description: This account will be allowed to invoke the lambda
      default: arn:aws:iam::058607598222:root
    allowlistedEnvironment:
      description: >-
        The ESC environment(s) that are allowed to use the rotation lambda.
        Pulumi will set fully qualified ESC environment name as an IAM external id when assuming
        the role to invoke the lambda like `{pulumi organization}/{esc project}/{esc env name}`.
        You can use `*` as wildcard to match more than one environment. For example, `myOrg/myProject/*` will match all environments in the `myProject` project. 
        See https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios_third-party.html
